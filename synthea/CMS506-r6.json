{
  "name": "CMS506-r6",
  "remarks": [
    "define \"Initial Population\":",
    "\"Inpatient Encounters With An Opioid Or Benzodiazepine At Discharge\"",
    "",
    "define \"Denominator\":",
    "\"Initial Population\"",
    "",
    "define \"Numerator\":",
    "  /*Encounters of patients prescribed two or more opioids or an opioid and benzodiazepine at discharge.*/",
    "  ",
    "  \"Denominator\" InpatientEncounter       ",
    "    where ( Count(\"Opioid At Discharge\" OpioidMedications",
    "            where OpioidMedications.authoredOn during day of InpatientEncounter.period ",
    "                return distinct OpioidMedications.medication ",
    "                    ) >= 2",
    "            )",
    "        or exists ( \"Opioid At Discharge\" OpioidDischargeMedications",
    "            where OpioidDischargeMedications.authoredOn during day of InpatientEncounter.period ",
    "                and exists \"Benzodiazepine At Discharge\" BenzodiazepineDischargeMedication",
    "                    where BenzodiazepineDischargeMedication.authoredOn during day of InpatientEncounter.period",
    "                    )"
  ],
  "states": {
    "Initial": {
      "type": "Initial",
      "direct_transition": "Age_Guard"
    },
    "Terminal": {
      "type": "Terminal"
    },
    "IPP_Encounter": {
      "type": "Encounter",
      "encounter_class": "ambulatory",
      "reason": "",
      "codes": [
        {
          "system": "SNOMED-CT",
          "code": 32485007,
          "display": "Hospital admission (procedure)"
        }
      ],
      "direct_transition": "Order_Med",
      "remarks": [
        "define \"Inpatient Encounter With Age Greater Than Or Equal To 18\":",
        "  CQMCommon.\"Inpatient Encounter\" InpatientHospitalEncounter",
        "                  where AgeInYearsAt(date from start of InpatientHospitalEncounter.period) >= 18"
      ]
    },
    "Medication_Discharge_Opioid": {
      "type": "MedicationOrder",
      "codes": [
        {
          "system": "RxNorm",
          "code": 861467,
          "display": "meperidine hydrochloride 50 MG Oral Tablet"
        }
      ],
      "direct_transition": "Med_Delay",
      "administration": false,
      "assign_to_attribute": "discharge_med",
      "remarks": [
        "define \"Opioid At Discharge\":",
        "  [\"MedicationRequest\": medication in \"Schedule II, III and IV Opioid Medications\"] OpioidMedications",
        "    where (OpioidMedications.isCommunity() or OpioidMedications.isDischarge()) ",
        "        and OpioidMedications.status in { 'active', 'completed' }",
        "        and OpioidMedications.intent = 'order'"
      ]
    },
    "Hospital_Stay_End": {
      "type": "EncounterEnd",
      "distributed_transition": [
        {
          "transition": "Terminal",
          "distribution": 0.01
        },
        {
          "transition": "Hospital_Encounter_Delay",
          "distribution": 0.99
        }
      ]
    },
    "Age_Guard": {
      "type": "Guard",
      "allow": {
        "condition_type": "Age",
        "operator": ">=",
        "quantity": 18,
        "unit": "years",
        "value": 0
      },
      "direct_transition": "Hospital_Encounter_Delay"
    },
    "Hospital_Encounter_Delay": {
      "type": "Delay",
      "range": {
        "low": 0,
        "high": 3,
        "unit": "years"
      },
      "direct_transition": "IPP_Encounter"
    },
    "Medication_Discharge_Benzodiazepine": {
      "type": "MedicationOrder",
      "codes": [
        {
          "system": "RxNorm",
          "code": 1298088,
          "display": "Flurazepam Hydrochloride 15 MG Oral Capsule"
        }
      ],
      "direct_transition": "Med_Delay",
      "assign_to_attribute": "discharge_med",
      "remarks": [
        "define \"Benzodiazepine At Discharge\":",
        "  [\"MedicationRequest\": medication in \"Schedule IV Benzodiazepines\"] BenzoMedications",
        "    where (BenzoMedications.isCommunity() or BenzoMedications.isDischarge()) ",
        "        and BenzoMedications.status in { 'active', 'completed' }",
        "        and BenzoMedications.intent = 'order'"
      ]
    },
    "Order_Med": {
      "type": "Simple",
      "distributed_transition": [
        {
          "transition": "Medication_Discharge_Opioid",
          "distribution": 0.5
        },
        {
          "transition": "Medication_Discharge_Benzodiazepine",
          "distribution": 0.5
        }
      ]
    },
    "Hospital_Stay_Delay": {
      "type": "Delay",
      "exact": {
        "quantity": 1,
        "unit": "days"
      },
      "direct_transition": "Order_Med"
    },
    "Med_Delay": {
      "type": "Delay",
      "range": {
        "low": 1,
        "high": 2,
        "unit": "hours"
      },
      "direct_transition": "End_Discharge_Med"
    },
    "End_Discharge_Med": {
      "type": "MedicationEnd",
      "distributed_transition": [
        {
          "transition": "Hospital_Stay_End",
          "distribution": 0.2
        },
        {
          "transition": "Hospital_Stay_Delay",
          "distribution": 0.8
        }
      ],
      "referenced_by_attribute": "discharge_med"
    }
  },
  "gmf_version": 2
}